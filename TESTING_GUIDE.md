# 🧪 系统测试指南

## 快速验证真实数据

### 1. 启动系统

```bash
# 确保使用Node.js 18+
node --version  # 应该 >= 18.17.0

# 启动开发服务器
npm run dev

# 访问地址
http://localhost:3000
```

### 2. 测试 A 股市场数据

#### 📊 市场指数测试

1. 访问首页，点击"A 股市场"
2. 查看三大指数卡片：
   - 上证指数 (sh000001)
   - 深证成指 (sz399001)
   - 创业板指 (sz399006)
3. ✅ 验证点：
   - 显示实时点位
   - 显示涨跌幅（红涨绿跌）
   - 显示成交量和成交额
   - 数据每 30 秒自动刷新

#### 📈 热门股票测试

1. 在 A 股市场页面，测试三个榜单切换：
   - 点击"涨幅榜"按钮
   - 点击"跌幅榜"按钮
   - 点击"成交量榜"按钮
2. ✅ 验证点：
   - 榜单切换流畅
   - 显示真实股票代码和名称
   - 显示当前价格和涨跌幅
   - 数据每 30 秒自动刷新

#### 🔍 个股详情测试

1. 点击任意股票卡片
2. 查看个股详情页面
3. ✅ 验证点：
   - 显示股票名称和代码
   - 显示实时价格、涨跌幅
   - 显示开盘、最高、最低、昨收
   - 显示 K 线图（多周期切换）
   - 显示五档买卖盘口
   - 数据每 10 秒自动刷新

#### 💰 主力资金测试

1. 点击导航栏"主力资金"
2. 查看资金流向榜单
3. ✅ 验证点：
   - 显示主力净流入金额
   - 显示超大单、大单、中单、小单流向
   - 支持按主力净流入和涨跌幅排序
   - 资金单位自动格式化（亿/万）

### 3. 测试美股市场数据

#### 📊 美股指数测试

1. 点击首页"美股市场"或导航栏"美股市场"
2. 查看三大指数卡片：
   - 道琼斯指数
   - 纳斯达克指数
   - 标普 500 指数
3. ✅ 验证点：
   - 显示实时点位（美元）
   - 显示涨跌幅
   - 美股交易时间数据更新
   - 非交易时间显示上日收盘数据

#### 📈 热门美股测试

1. 在美股市场页面查看热门股票
2. ✅ 验证点：
   - 显示 AAPL、TSLA、GOOGL 等热门股票
   - 显示美元价格
   - 按涨跌幅排序
   - 数据每 60 秒自动刷新

#### 🔍 美股个股详情测试

1. 点击任意美股卡片（如 AAPL）
2. 查看个股详情
3. ✅ 验证点：
   - 显示美元价格
   - 显示 K 线图（日 K/周 K/月 K）
   - 显示成交量（以 M 为单位）

## 常见测试用例

### A 股推荐测试股票

- **银行股**: 600000 (浦发银行), 600036 (招商银行)
- **科技股**: 000063 (中兴通讯), 002230 (科大讯飞)
- **新能源**: 300750 (宁德时代), 002594 (比亚迪)
- **白酒**: 600519 (贵州茅台), 000858 (五粮液)

访问方式：

```
http://localhost:3000/a-share/stock/600000
http://localhost:3000/a-share/stock/300750
```

### 美股推荐测试股票

- **科技巨头**: AAPL (苹果), MSFT (微软), GOOGL (谷歌)
- **电商**: AMZN (亚马逊)
- **电动车**: TSLA (特斯拉), NIO (蔚来)
- **社交媒体**: META (Meta)
- **芯片**: NVDA (英伟达), AMD (AMD)

访问方式：

```
http://localhost:3000/us-market/stock/AAPL
http://localhost:3000/us-market/stock/TSLA
```

## 数据验证标准

### ✅ 数据正常标准

1. **数字格式正确**

   - 价格显示两位小数
   - 涨跌幅显示百分号
   - 成交量单位正确（万/亿/M）

2. **颜色语义正确**

   - 上涨显示红色
   - 下跌显示绿色
   - 正值前带"+"号

3. **交互正常**

   - 点击股票能跳转详情
   - K 线图可缩放拖动
   - 周期切换即时生效
   - 榜单排序正确

4. **刷新正常**
   - 页面自动刷新数据
   - 加载状态显示友好
   - 无控制台错误

### ❌ 常见问题排查

#### 问题 1: 数据不显示或显示"加载中..."

**可能原因**：

- 网络连接问题
- API 访问受限
- 非交易时间（股市休市）

**解决方案**：

```bash
# 1. 检查网络
ping sina.com.cn

# 2. 查看控制台错误
# 打开浏览器开发者工具 -> Console

# 3. 检查API响应
# 开发者工具 -> Network -> 查看API请求状态
```

#### 问题 2: 数据显示异常（全是 0 或 NaN）

**可能原因**：

- API 返回格式变化
- 数据解析错误

**解决方案**：

```bash
# 查看服务器日志
# 终端会显示API错误信息

# 检查具体API接口
curl "https://hq.sinajs.cn/list=sh000001"
```

#### 问题 3: K 线图不显示

**可能原因**：

- K 线数据获取失败
- ECharts 初始化问题

**解决方案**：

```javascript
// 查看浏览器控制台是否有错误
// K线API可能返回空数组，这是正常的
// 美股K线数据可能受限
```

#### 问题 4: 跨域错误（CORS）

**可能原因**：

- 浏览器阻止跨域请求

**解决方案**：

```bash
# 已在next.config.js中配置CORS
# 如果还有问题，确保使用的是Next.js API路由
# 不要直接在浏览器访问第三方API
```

## 性能测试

### 页面加载速度

```bash
# 使用Chrome DevTools
# 1. 打开开发者工具
# 2. Performance标签
# 3. 录制页面加载
# 4. 查看First Contentful Paint和Time to Interactive

# 正常标准：
# - FCP < 1.5s
# - TTI < 3s
```

### 内存使用

```bash
# Chrome DevTools -> Memory
# 录制页面使用情况
# 正常标准：内存占用 < 100MB
```

### 网络请求

```bash
# Chrome DevTools -> Network
# 查看API请求数量和大小
# 正常标准：
# - API响应时间 < 500ms
# - 总请求数 < 50个（首次加载）
```

## 自动化测试（可选）

### 使用 curl 测试 API

```bash
# A股指数
curl "http://localhost:3000/api/a-share/indices"

# A股热门股票
curl "http://localhost:3000/api/a-share/hot?type=rise&limit=10"

# 个股行情
curl "http://localhost:3000/api/a-share/quote/600000"

# K线数据
curl "http://localhost:3000/api/a-share/kline/600000?period=day&count=10"

# 主力资金
curl "http://localhost:3000/api/capital-flow?limit=10"

# 美股指数
curl "http://localhost:3000/api/us-market/indices"

# 美股热门
curl "http://localhost:3000/api/us-market/hot?limit=10"
```

### 预期返回格式

```json
{
  "success": true,
  "data": [
    // 数据数组
  ]
}
```

## 交易时间说明

### A 股交易时间

- **开盘时间**: 9:30 - 11:30, 13:00 - 15:00（周一至周五）
- **集合竞价**: 9:15 - 9:25
- **休市**: 周末、节假日

### 美股交易时间（北京时间）

- **夏令时**: 21:30 - 次日 4:00
- **冬令时**: 22:30 - 次日 5:00
- **休市**: 周末、美国节假日

### 数据更新说明

- ✅ 交易时间：实时数据（延迟 3-5 秒）
- ⏸️ 非交易时间：显示上一交易日收盘数据
- 🔄 自动刷新会持续运行（即使非交易时间）

## 测试检查清单

```
□ 首页正常显示三个入口
□ A股市场指数正常显示
□ A股热门榜单可切换
□ A股个股详情页正常
□ A股K线图正常显示
□ A股买卖盘口正常
□ 主力资金榜单正常
□ 美股市场指数正常
□ 美股热门股票正常
□ 美股个股详情正常
□ 所有链接可正常跳转
□ 数据自动刷新正常
□ 移动端显示正常
□ 无控制台错误
```

## 问题反馈

如发现问题，请记录：

1. 页面 URL
2. 操作步骤
3. 预期结果
4. 实际结果
5. 浏览器控制台错误信息
6. 网络请求响应内容

---

**测试完成后，系统应该能正常显示所有真实股市数据！** 🎉
